<%= link_to "Back to course view", course_path(@quiz.course), class: 'button' %>
<%= link_to "Back to all courses", courses_path, class: 'button' %>

<h2> <%= @quiz.course.title %> </h2>
<h3> <%= @quiz.title %> </h3>

<% if @quiz.questions.any? %>
  <ul>
    <% @quiz.questions.each do |question| %>
      <li><%= question.text %><br>
      <%= question.answers.pluck(:text) %></li>
    <% end %>
</ul>
<% end %>

<% if @quiz.course.user == current_user || current_user.admin? %>
  <h4> Add a new question </h4>
  <%= form_for [@quiz, @question] do |f| %>
  <% if @question.errors.any? %>
  <div id="error_explanation">
    <h3><%= pluralize(@question.errors.count, "error") %> prohibited this quiz from being submitted:</h3>
    <ul>
    <% @question.errors.full_messages.each do |msg| %>
      <li><%= msg %></li>
    <% end %>
    </ul>
  </div>

<% end %>
  <p>
    <%= f.label :text, "Question text" %><br>
    <%= f.text_field :text %>
  </p>
  <p>
    <%= fields_for "correct_answer", @question.answers.build do |answer| %>
      <%= answer.label :text, "Correct Answer" %><br>
      <%= answer.text_field :text %>
    <% end %>
  </p>

  <% @question.wrong_answers.each_with_index do |answer, i| %>
    <%= fields_for "wrong_answers[#{i}]", answer do |f| %>
      <p>
      <%= f.label :text, "Wrong Answer" %><br>
      <%= f.text_field :text %>
      </p>
    <% end %>
  <% end %>

  <%= f.submit %>
  <% end %>
<% end %>
